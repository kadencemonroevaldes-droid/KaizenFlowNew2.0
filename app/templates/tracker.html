<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kaizen Flow | Tracker</title>
<link rel="stylesheet" href="/static/css/style.css">
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>
<body>
<nav class="nav">
  <div class="nav__inner">
    <div class="logo"> Kaizen Flow</div>
    <div class="links">
      <a href="/">Dashboard</a>
      <a href="/tracker" class="active">Tracker</a>
      <a href="/culture">Culture Lens</a>
    </div>
  </div>
</nav>

<main>
  <section class="container">
    <div class="layout-split">
      <div class="form-card" id="log-idea">
        <span class="tag">Log an improvement</span>
        <h2>Capture a fresh idea</h2>
        <p>Document the change, align it with an SDG, and watch the progress signal update instantly across the platform.</p>
        <form method="post" action="/add" class="form-grid">
          <input name="title" placeholder="Idea title" required>
          <input name="goal" placeholder="What outcome does this support?" required>
          <select name="sdg">
            <option value="3 Good Health">SDG 3 路 Good Health</option>
            <option value="4 Quality Education">SDG 4 路 Quality Education</option>
            <option value="5 Gender Equality">SDG 5 路 Gender Equality</option>
            <option value="13 Climate Action">SDG 13 路 Climate Action</option>
            <option value="17 Partnerships">SDG 17 路 Partnerships</option>
          </select>
          <button type="submit">Save idea </button>
        </form>
      </div>

      <div class="table-card">
        <div class="panel-header">
          <h2>Idea portfolio</h2>
          <p class="muted">Every entry is assigned a random progress signal to simulate movement through delivery.</p>
        </div>
        {% if ideas %}
          <table>
            <thead>
              <tr><th>Title</th><th>Goal</th><th>SDG</th><th>Progress</th></tr>
            </thead>
            <tbody>
              {% for i in ideas|sort(attribute='date_logged', reverse=true) %}
                <tr>
                  <td>{{ i.title }}</td>
                  <td>{{ i.goal }}</td>
                  <td><span class="badge">{{ i.sdg }}</span></td>
                  <td>
                    <span class="badge {% if i.progress > 74 %}success{% elif i.progress < 50 %}warning{% endif %}">{{ i.progress }}%</span>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <div class="empty-state">
            Start by adding your first idea to see the tracker populate in real-time.
          </div>
        {% endif %}
      </div>
    </div>

    <div class="panel" style="margin-top:2rem;">
      <div>
        <h3>Progress Trend</h3>
        <small>Spot momentum shifts as initiatives move from exploration to adoption.</small>
      </div>
      <div id="chart"></div>
    </div>
  </section>
</main>

<footer>
  Ready to celebrate the next improvement? Keep logging, keep sharing.
</footer>

<script>
const data = {{ ideas|map(attribute='progress')|list|tojson }};
if (data.length > 0) {
  const options = {
    chart: { type: 'area', height: 280, toolbar: { show: false } },
    series: [{ name: 'Progress', data }],
    stroke: { width: 3, curve: 'smooth' },
    fill: {
      type: 'gradient',
      gradient: {
        shadeIntensity: 0.5,
        opacityFrom: 0.7,
        opacityTo: 0.2,
        stops: [0, 90, 100]
      }
    },
    colors: ['#2563eb'],
    markers: { size: 4 },
    dataLabels: { enabled: false },
    grid: { borderColor: 'rgba(148, 163, 184, 0.18)' },
    xaxis: { labels: { show: false }, axisBorder: { show: false }, axisTicks: { show: false } },
    yaxis: { min: 0, max: 100, tickAmount: 4 }
  };
  new ApexCharts(document.querySelector('#chart'), options).render();
} else {
  document.querySelector('#chart').innerHTML = '<div class="empty-state">Add at least one idea to generate the progress trend visual.</div>';
}
</script>
</body>
</html>
